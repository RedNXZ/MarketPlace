<h1>Каталог товаров</h1>

<nav>
  <strong>Категории:</strong>
  <%= link_to "Все", products_path %> |
  <% Category.all.each do |category| %>
    <%= link_to category.name, products_path(category_id: category.id) %> |
  <% end %>
</nav>

<div class="row">
  <% @products.each do |product| %>
    <div class="col-md-4 mb-4">
      <div class="card h-100">
        <% if product.image.attached? %>
          <%= image_tag product.image, class: "card-img-top", alt: product.name %>
        <% end %>
        <div class="card-body">
          <h5 class="card-title"><%= product.name %></h5>
          <p class="card-text"><%= truncate(product.description, length: 100) %></p>
          <p class="card-text fw-bold">Цена: <%= number_to_currency(product.price, unit: "₽") %></p>
          <%= link_to 'Подробнее', product_path(product), class: 'btn btn-outline-primary btn-sm' %>

          <% if user_signed_in? %>
            <%= button_to 'Добавить в корзину', add_to_cart_path(product), method: :post, class: 'btn btn-success btn-sm mt-2' %>
          <% else %>
            <p class="mt-2"><%= link_to 'Войдите, чтобы добавить в корзину', new_user_session_path %></p>
          <% end %>
        </div>
      </div>
    </div>
  <% end %>
</div>